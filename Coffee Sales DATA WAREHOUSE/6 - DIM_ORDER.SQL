CREATE TABLE DIM_ORDER(
	DIM_ORDER_ID INT PRIMARY KEY,
	DIM_DATE_ID INT NOT NULL FOREIGN KEY REFERENCES DIM_DATE(DIM_DATE_ID) ON DELETE CASCADE ON UPDATE CASCADE
)

INSERT INTO DIM_ORDER
SELECT DISTINCT
	ORDER_ID AS DIM_ORDER_ID,
	DIM_DATE_ID AS DATE_ID
FROM COFFEE_SALES.DBO."ORDER" A
INNER JOIN DIM_DATE B ON A.ORDER_DATE_ID = B.DIM_DATE_ID
WHERE NOT EXISTS(
	SELECT 1
	FROM DIM_ORDER
	WHERE A.ORDER_ID = DIM_ORDER_ID
)