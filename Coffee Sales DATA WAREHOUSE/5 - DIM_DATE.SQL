CREATE TABLE DIM_DATE(
	DIM_DATE_ID INT PRIMARY KEY,
	DATE DATE NOT NULL,
	YEAR AS DATEPART(YEAR, DATE),
	QUARTER AS DATEPART(QUARTER, DATE),
	MONTH AS DATEPART(MONTH, DATE),
	WEEK AS DATEPART(WEEK, DATE),
	DAY AS DATEPART(DAYOFYEAR, DATE)
)

INSERT INTO DIM_DATE
SELECT DISTINCT
	ORDER_DATE_ID AS DIM_DATE_ID,
	ORDER_DATE AS DATE
FROM COFFEE_SALES.DBO.ORDER_DATE A
WHERE NOT EXISTS(
	SELECT 1
	FROM DIM_DATE
	WHERE A.ORDER_DATE_ID = DIM_DATE_ID
)